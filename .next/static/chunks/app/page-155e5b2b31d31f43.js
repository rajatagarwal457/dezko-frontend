(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1491:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});var a=r(926);let n=(0,a.createServerReference)("7f580b45312e5b1e80cc6761511700796bfbf0e96c",a.callServer,void 0,a.findSourceMapURL,"invalidateCacheAction")},5387:(e,t,r)=>{Promise.resolve().then(r.bind(r,6227))},6227:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var a=r(5155),n=r(2115),i=r(9735),o=r(8007),s=r(9427),l=r(7494),d=r(9384),c=function(e){return e.LANDING="LANDING",e.PROCESSING="PROCESSING",e.RESULT="RESULT",e.DASHBOARD="DASHBOARD",e}({});let m=e=>{let{children:t,variant:r="primary",size:n="md",isLoading:i,className:o="",...s}=e;return(0,a.jsxs)("button",{className:"".concat("font-bold rounded-full transition-all duration-200 transform hover:scale-105 active:scale-95 focus:outline-none focus:ring-4 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"," ").concat({primary:"bg-vireo-pink text-white shadow-lg hover:shadow-xl focus:ring-vireo-pink/30 hover:bg-[#ff5252]",secondary:"bg-vireo-yellow text-vireo-dark shadow-md hover:shadow-lg focus:ring-vireo-yellow/30 hover:bg-[#ffdf40]",outline:"border-2 border-vireo-purple text-vireo-purple hover:bg-vireo-purple hover:text-white"}[r]," ").concat({sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-4 text-xl"}[n]," ").concat(o),disabled:i||s.disabled,...s,children:[i?(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,t]})};var u=r(1654),x=r(5229),h=r(6191);let p="http://44.200.94.8:8000",g={async getUploadUrl(e,t,r){let a=await fetch("".concat(p,"/get-upload-url"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,filename:t,content_type:r})});if(!a.ok)throw Error("Failed to get upload URL: ".concat(a.statusText));return a.json()},async uploadVideos(e,t,r){let a=t.replace(/[^a-zA-Z0-9]/g,"_"),n=crypto.randomUUID(),i="".concat(a,"-").concat(n),o=e.map(async e=>{let t=e.name,{upload_url:r}=await this.getUploadUrl(i,t,e.type),a=await fetch(r,{method:"PUT",body:e,headers:{"Content-Type":e.type}});if(!a.ok)throw Error("Upload failed for ".concat(t,": ").concat(a.statusText));return t});return{message:"Uploads successful",files:await Promise.all(o),session_id:i}},async generateVideo(e,t,r){let a={sessionId:e,fileNames:t,...r&&{vibe:r}},n=await fetch("".concat(p,"/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok)throw Error((await n.json().catch(()=>({detail:n.statusText}))).detail||"Video generation failed");return n.json()},async logError(e){let t={error:e.message},r=await fetch("".concat(p,"/error"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error("Error logging failed: ".concat(r.statusText));return r.json()},async getSongs(){let e=await fetch("".concat(p,"/songs"));if(!e.ok)throw Error("Failed to fetch songs: ".concat(e.statusText));return e.json()},async clearUploads(){let e=await fetch("".concat(p,"/clear"),{method:"DELETE"});if(!e.ok)throw Error("Clear failed: ".concat(e.statusText));return e.json()},async checkVideoStatus(e,t){try{let r=t||this.getVideoUrl(e),a=await fetch(r,{method:"HEAD"});return{exists:a.ok,ready:a.ok}}catch(e){return{exists:!1,ready:!1}}},getVideoUrl:e=>"".concat(p,"/outputs/").concat(e),async getUserQuota(e){try{let t=await fetch("".concat(p,"/user-quota/").concat(e));if(!t.ok)return{generationCount:0,isPremium:!1};return t.json()}catch(e){return console.error("Failed to fetch user quota:",e),{generationCount:0,isPremium:!1}}},async syncQuota(e,t){try{await fetch("".concat(p,"/sync-quota"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,generationCount:t})})}catch(e){console.error("Failed to sync quota:",e)}}},f=[{id:"party",label:"Party",emoji:"\uD83C\uDF89"},{id:"nostalgia",label:"Nostalgia",emoji:"\uD83D\uDCFC"},{id:"cute",label:"Cute",emoji:"\uD83D\uDC96"},{id:"hardcore",label:"Hardcore",emoji:"⚡"},{id:"lovey-dovey",label:"Lovey Dovey",emoji:"\uD83E\uDD70"},{id:"2025-throwback",label:"2025 Throwback",emoji:"\uD83D\uDD01"}],v=e=>{let{onStartProcessing:t,isSignedIn:r,isProcessing:o=!1,userId:s,userName:l,userEmail:d,canGenerate:c=!0,onShowPaymentModal:p}=e,[v,y]=(0,n.useState)([]),[b,w]=(0,n.useState)(!1),[j,N]=(0,n.useState)(!1),[k,S]=(0,n.useState)(null),[C,P]=(0,n.useState)(!1),[_,A]=(0,n.useState)(null),U=(0,n.useRef)(null),E=(0,n.useRef)(!1),D=(0,n.useRef)(null),T=async e=>{if(!r||!e)return;let t=[];for(let r of Array.from(e)){if(v.length+t.length>=20){alert("Maximum ".concat(20," clips allowed!"));break}if(!r.type.startsWith("video/"))continue;if(r.size>0x19000000){alert("File ".concat(r.name," is too large (Max ").concat(400,"MB)"));continue}let e=new File([new Blob([await r.arrayBuffer()],{type:r.type})],r.name,{type:r.type,lastModified:r.lastModified}),a=URL.createObjectURL(e);t.push({id:Math.random().toString(36).substr(2,9),file:e,previewUrl:a,name:r.name})}y(e=>[...e,...t])},R=async()=>{if(!s||!l)return void alert("User information not available. Please sign in.");N(!0),P(!0),E.current=!0;try{let e=v.map(e=>e.file),t=await g.uploadVideos(e,l,s);A(t),U.current=t,P(!1),E.current=!1}catch(e){console.error("Upload failed:",e),await g.logError(e),P(!1),E.current=!1,U.current=null,alert("Upload failed. Please try again."),N(!1)}};return(0,a.jsxs)("div",{className:"w-full max-w-3xl mx-auto px-4 animate-fade-in flex flex-col items-center",children:[(0,a.jsxs)("div",{className:"text-center mb-8 md:mb-12",children:[(0,a.jsxs)("h1",{className:"text-4xl md:text-6xl font-black text-vireo-dark mb-4 tracking-tight leading-tight dark:text-white",children:["Main character energy, ",(0,a.jsx)("span",{className:"text-vireo-teal inline-block transform hover:rotate-2 transition-transform cursor-default",children:"instantly."})]}),(0,a.jsx)("p",{className:"text-lg md:text-xl text-gray-500 font-medium",children:"Vireo turns forgotten clips into stories worth sharing."})]}),(0,a.jsxs)("div",{className:"w-full relative transition-all duration-500 ".concat(j?"min-h-[520px] md:min-h-[400px]":"min-h-[300px]"),children:[(0,a.jsxs)("div",{className:"\n            w-full bg-white rounded-3xl border-4 border-dashed transition-all duration-500 group absolute inset-0\n            h-[300px] flex flex-col items-center justify-center p-8\n            ".concat(j?"opacity-0 scale-95 pointer-events-none z-0":"opacity-100 scale-100 z-10","\n            ").concat(b?"border-vireo-pink bg-vireo-pink/5 scale-105":"border-gray-200 hover:border-vireo-teal hover:bg-vireo-teal/5","\n            dark:bg-gray-800 dark:border-gray-700 dark:hover:border-vireo-teal dark:hover:bg-vireo-teal/10\n          "),onDragOver:e=>{e.preventDefault(),r&&!j&&w(!0)},onDragLeave:e=>{e.preventDefault(),w(!1)},onDrop:e=>{e.preventDefault(),w(!1),r&&!j&&T(e.dataTransfer.files)},onClick:()=>{if(r&&!j){var e;null==(e=D.current)||e.click()}},children:[(0,a.jsx)("input",{type:"file",ref:D,className:"hidden",multiple:!0,accept:"video/*",onChange:e=>T(e.target.files)}),0===v.length?(0,a.jsxs)("div",{className:"text-center pointer-events-none",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-vireo-yellow rounded-full flex items-center justify-center mx-auto mb-6 transform group-hover:scale-110 group-hover:rotate-6 transition-transform",children:(0,a.jsx)(u.A,{className:"w-10 h-10 text-vireo-orange"})}),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-vireo-dark mb-2 dark:text-white",children:"Drop your clips here \uD83D\uDCF8"}),(0,a.jsx)("p",{className:"text-gray-400 dark:text-gray-300",children:"or click to browse files"})]}):(0,a.jsxs)("div",{className:"pointer-events-auto",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-vireo-dark mb-2 dark:text-white",children:"Sign in to upload clips \uD83D\uDD12"}),(0,a.jsx)(i.hZ,{mode:"modal",children:(0,a.jsx)("button",{className:"mt-2 px-6 py-2 bg-vireo-teal text-white rounded-lg font-bold hover:bg-opacity-90 transition-all",onClick:e=>e.stopPropagation(),children:"Sign In"})})]})]}):(0,a.jsx)("div",{className:"w-full h-full overflow-y-auto pointer-events-auto cursor-default px-2",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full pb-4",children:[v.map(e=>(0,a.jsxs)("div",{className:"relative aspect-square bg-gray-100 rounded-xl overflow-hidden group/item shadow-sm",children:[(0,a.jsx)("video",{src:e.previewUrl,className:"w-full h-full object-cover"}),(0,a.jsx)("button",{onClick:()=>(e=>{y(t=>{let r=t.filter(t=>t.id!==e),a=t.find(t=>t.id===e);return a&&URL.revokeObjectURL(a.previewUrl),r})})(e.id),className:"absolute top-2 right-2 bg-white/90 p-1 rounded-full text-red-500 opacity-0 group-hover/item:opacity-100 transition-opacity hover:bg-white",children:(0,a.jsx)(x.A,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/50 to-transparent p-2",children:(0,a.jsx)("p",{className:"text-xs text-white truncate",children:e.name})})]},e.id)),v.length<20&&(0,a.jsxs)("button",{onClick:()=>{var e;return null==(e=D.current)?void 0:e.click()},className:"aspect-square rounded-xl border-2 border-dashed border-gray-300 flex flex-col items-center justify-center text-gray-400 hover:border-vireo-teal hover:text-vireo-teal hover:bg-white transition-colors",children:[(0,a.jsx)(h.A,{className:"w-8 h-8 mb-1"}),(0,a.jsx)("span",{className:"text-xs font-bold",children:"Add More"})]})]})})]}),(0,a.jsx)("div",{className:"\n            w-full bg-white rounded-3xl border-4 border-vireo-teal transition-all duration-500 absolute inset-0\n            h-[520px] md:h-[400px] flex flex-col items-center justify-center p-4 md:p-8\n            ".concat(j?"opacity-100 scale-100 z-10":"opacity-0 scale-95 pointer-events-none z-0","\n            dark:bg-gray-800 dark:border-vireo-teal\n          "),children:(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("h3",{className:"text-xl md:text-2xl font-bold text-vireo-dark mb-1 md:mb-2 text-center dark:text-white",children:"Choose your vibe ✨"}),(0,a.jsx)("p",{className:"text-sm md:text-base text-gray-500 text-center mb-4 md:mb-6",children:"Select the energy for your video"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-4",children:f.map(e=>(0,a.jsxs)("button",{onClick:()=>{S(e.id)},className:"\n                    p-4 md:p-6 rounded-2xl border-3 transition-all duration-300 flex flex-col items-center justify-center gap-1 md:gap-2\n                    ".concat(k===e.id?"border-vireo-pink bg-vireo-pink/10 scale-105 shadow-lg":"border-gray-200 bg-white hover:border-vireo-teal hover:bg-vireo-teal/5 hover:scale-105 shadow-md hover:shadow-lg","\n                    dark:border-gray-700 dark:bg-gray-800 dark:hover:border-vireo-teal\n                  "),children:[(0,a.jsx)("span",{className:"text-3xl md:text-4xl",children:e.emoji}),(0,a.jsx)("span",{className:"text-xs md:text-sm font-bold ".concat(k===e.id?"text-vireo-pink":"text-gray-700 dark:text-gray-300"),children:e.label})]},e.id))})]})})]}),(0,a.jsx)("div",{className:"mt-8 transition-all duration-500",children:j?(0,a.jsx)("div",{className:"transition-all duration-500 transform ".concat(k?"translate-y-0 opacity-100":"translate-y-10 opacity-0 pointer-events-none"),children:(0,a.jsx)(m,{size:"lg",variant:"primary",className:"text-xl px-12 py-5 shadow-vireo-pink/40 shadow-xl",onClick:()=>{if(!k)return;if(!c){null==p||p();return}let e=v.map(e=>e.name);t(new Promise(e=>{let t=()=>{U.current&&!E.current?e(U.current):setTimeout(t,100)};t()}),[],e,k)},disabled:!k,children:"Make me the main character ✨"})}):(0,a.jsx)("div",{className:"transition-all duration-500 transform ".concat(v.length>0?"translate-y-0 opacity-100":"translate-y-10 opacity-0 pointer-events-none"),children:(0,a.jsx)(m,{size:"lg",variant:"primary",className:"text-xl px-12 py-5 shadow-vireo-pink/40 shadow-xl",onClick:R,disabled:C,children:C?"Uploading...":"Upload ⬆️"})})})]})};var y=r(3648);function b(){let e=(0,y._)(["\n  position: relative;\n  width: 100%;\n  min-height: 20vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  @keyframes dropAndShift {\n    0% {\n      transform: translate(0px, 15px);\n    }\n    16.67% {\n      transform: translate(80px, 13px);\n    }\n    33.34% {\n      transform: translate(40px, 10px);\n    }\n    50.01% {\n      transform: translate(40px, -30px);\n    }\n    66.68% {\n      transform: translate(40px, 55px);\n    }\n    83.35% {\n      transform: translate(40px, 10px);\n    }\n    100% {\n      transform: translate(0px, 15px);\n    }\n  }\n  @keyframes bubbleGlint {\n    0% {\n      top: 3px;\n      left: 4px;\n      opacity: 0;\n    }\n    8.335% {\n      top: 6px;\n      left: 6px;\n      opacity: 0.5;\n    }\n    16.67% {\n      top: 3px;\n      left: 4px;\n      opacity: 0;\n    }\n    33.34% {\n      top: 3px;\n      left: 4px;\n      opacity: 0.5;\n    }\n    50.01% {\n      top: 3px;\n      left: 4px;\n      opacity: 0;\n    }\n    58.345% {\n      top: 6px;\n      left: 6px;\n      opacity: 0.5;\n    }\n    66.68% {\n      top: 3px;\n      left: 4px;\n      opacity: 0;\n    }\n    83.35% {\n      top: 6px;\n      left: 6px;\n      opacity: 0.5;\n    }\n    100% {\n      top: 3px;\n      left: 4px;\n      opacity: 0;\n    }\n  }\n\n  .Strich1 {\n    position: absolute;\n    width: 130px;\n    height: 50px;\n    background: #000;\n    border-radius: 25px;\n    transform: rotate(45deg);\n    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);\n    z-index: 0;\n  }\n  .Strich2 {\n    position: absolute;\n    width: 130px;\n    height: 50px;\n    background: #000;\n    border-radius: 25px;\n    transform: rotate(-90deg);\n    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);\n    z-index: 0;\n  }\n\n  .bubble {\n    position: absolute;\n    top: 0;\n    left: 15px;\n    width: 20px;\n    height: 20px;\n    border-radius: 50%;\n    background: radial-gradient(circle at 30% 30%, #ffb3c1, #e64980, #ff8787);\n    animation: dropAndShift 5s ease-in-out infinite;\n    z-index: 1;\n  }\n\n  .bubble1 {\n    position: absolute;\n    top: 0;\n    width: 20px;\n    height: 20px;\n    background: radial-gradient(circle at 30% 30%, #edb3ff, #ac49e6, #fb87ff);\n    border-radius: 50%;\n    left: 8px;\n    animation: dropAndShift 6s ease-in-out infinite;\n    z-index: 2;\n  }\n  .bubble2 {\n    position: absolute;\n    top: 0;\n    width: 20px;\n    height: 20px;\n    background: radial-gradient(circle at 30% 30%, #b3d8ff, #4963e6, #87a7ff);\n    border-radius: 50%;\n    left: 12px;\n    animation: dropAndShift 4s ease-in-out infinite;\n    z-index: 3;\n  }\n  .bubble3 {\n    position: absolute;\n    top: 0;\n    width: 20px;\n    height: 20px;\n    background: radial-gradient(circle at 30% 30%, #b3ffbc, #35a32f, #75ba61);\n    border-radius: 50%;\n    left: 10px;\n    animation: dropAndShift 7s ease-in-out infinite;\n    z-index: 4;\n  }\n\n  .bubble4 {\n    position: absolute;\n    top: 0;\n    width: 20px;\n    height: 20px;\n    background: radial-gradient(circle at 30% 30%, #fff3b3, #e6c049, #ffe787);\n    border-radius: 50%;\n    left: 18px;\n    animation: dropAndShift 5.5s ease-in-out infinite;\n    z-index: 5;\n  }\n"]);return b=function(){return e},e}let w=r(625).Ay.div(b()),j=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w,{children:(0,a.jsx)("div",{className:"Strich1",children:(0,a.jsxs)("div",{className:"Strich2",children:[(0,a.jsx)("div",{className:"bubble"}),(0,a.jsx)("div",{className:"bubble1"}),(0,a.jsx)("div",{className:"bubble2"}),(0,a.jsx)("div",{className:"bubble3"}),(0,a.jsx)("div",{className:"bubble4"})]})})}),(0,a.jsx)("div",{className:"text-center mt-4 text-gray-500",children:"Loading..."})]});var N=r(6826),k=r(9867),S=r(2014);let C=r(5704).env.API_KEY||"",P=null;C&&(P=new S.M4({apiKey:C}));let _=async e=>{if(!P)return"My Awesome Story";try{var t;let r="\n      I have a video edited from these clips: ".concat(e.join(", "),'.\n      Give me a single, short, punchy, fun, "Main Character Energy" title for this video.\n      Do not add quotes. Max 5 words.\n    ');return(null==(t=(await P.models.generateContent({model:"gemini-2.5-flash",contents:r})).text)?void 0:t.trim())||"Main Character Energy"}catch(e){return console.error("Gemini generation error:",e),"Main Character Energy"}},A=()=>(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/90 backdrop-blur-sm rounded-2xl z-10",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative w-20 h-20",children:[(0,a.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-vireo-teal/30"}),(0,a.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-vireo-teal border-r-vireo-pink animate-spin"}),(0,a.jsx)("div",{className:"absolute inset-3 rounded-full bg-gradient-to-br from-vireo-teal to-vireo-pink animate-pulse"}),(0,a.jsx)("div",{className:"absolute inset-6 rounded-full bg-white"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-white font-bold text-lg mb-1",children:"Loading your video..."}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"This won't take long ✨"})]})]})}),U=e=>{let{clips:t,videoUrl:r,onReset:i,onViewGallery:o}=e,[s,l]=(0,n.useState)("Your Vireo Story"),[d,c]=(0,n.useState)(null),[u,x]=(0,n.useState)(!0),h=r||(t.length>0?t[0].previewUrl:"");(0,n.useEffect)(()=>{(async()=>{let e=t.map(e=>e.name);l(await _(e))})()},[t]),(0,n.useEffect)(()=>{r&&x(!0)},[r]),(0,n.useEffect)(()=>{r&&!d&&fetch(r).then(e=>e.blob()).then(e=>c(e)).catch(e=>console.error("Failed to cache video:",e))},[r,d]);let p=async()=>{if(!navigator.canShare)return void alert("Sharing not supported on this device");try{let e;if(d)e=d;else{let t=await fetch(r);e=await t.blob()}let t=new File([e],"vireo_video.mp4",{type:"video/mp4"});navigator.canShare({files:[t]})?await navigator.share({files:[t],title:"My Vireo Story",text:"Check out this video I made with Vireo! #MainCharacterEnergy"}):alert("File sharing not supported")}catch(e){console.log("Share failed:",e)}};return(0,a.jsxs)("div",{className:"w-full max-w-4xl mx-auto animate-fade-in pb-12",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h2",{className:"text-3xl md:text-4xl font-extrabold text-vireo-dark mb-2 dark:text-white",children:"Main character unlocked. ✨"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Your story is ready to fly."})]}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-xl overflow-hidden border-4 border-vireo-teal dark:border-vireo-teal/50 p-2 md:p-4 mb-8 max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"relative aspect-[9/16] bg-black rounded-2xl overflow-hidden group",children:[u&&(0,a.jsx)(A,{}),(0,a.jsx)("video",{src:h,className:"w-full h-full object-contain",controls:!0,autoPlay:!0,loop:!0,playsInline:!0,onCanPlayThrough:()=>x(!1),onLoadedData:()=>x(!1)})]})}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 justify-center items-center",children:[(0,a.jsxs)(m,{onClick:p,variant:"secondary",size:"lg",className:"w-full md:w-auto",children:[(0,a.jsx)(N.A,{className:"w-5 h-5"}),"Post on Instagram"]}),(0,a.jsxs)(m,{onClick:()=>{let e=document.createElement("a");e.href=h,e.download="Vireo_Edit_".concat(Date.now(),".mp4"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},variant:"primary",size:"lg",className:"w-full md:w-auto",children:[(0,a.jsx)(k.A,{className:"w-5 h-5"}),"Download Video"]})]}),(0,a.jsxs)("div",{className:"mt-8 text-center",children:[(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-vireo-teal underline text-sm",children:"Make another one"}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-vireo-teal underline text-sm",children:"View gallery"})})]})]})},E="vireo_video_renders",D={saveVideoRender(e){let t=this.getVideoRenders(e.userId);t.push(e),this._saveToStorage(t)},getVideoRenders(e){return this._loadFromStorage().filter(t=>t.userId===e)},updateVideoStatus(e,t){let r=this._loadFromStorage(),a=r.find(t=>t.id===e);a&&(a.status=t,this._saveToStorage(r))},getVideoRender(e){return this._loadFromStorage().find(t=>t.id===e)},deleteVideoRender(e){let t=this._loadFromStorage().filter(t=>t.id!==e);this._saveToStorage(t)},_loadFromStorage(){try{let e=localStorage.getItem(E);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load video renders from storage:",e),[]}},_saveToStorage(e){try{localStorage.setItem(E,JSON.stringify(e))}catch(e){console.error("Failed to save video renders to storage:",e)}}};var T=r(6983),R=r(2529),z=r(8874),V=r(7209),I=r(5921);let F=e=>{let{onCreateNew:t,onViewVideo:r}=e,{user:o}=(0,i.Jd)(),[s,l]=(0,n.useState)([]),[d,c]=(0,n.useState)(new Set);(0,n.useEffect)(()=>{o&&u()},[o]);let u=()=>{if(!o)return;let e=D.getVideoRenders(o.id);e.sort((e,t)=>t.createdAt-e.createdAt),l(e),e.forEach(e=>{"generating"===e.status&&x(e.id,e.filename,e.videoUrl)})},x=(e,t,r)=>{if(d.has(e))return;c(t=>new Set(t).add(e));let a=setInterval(async()=>{(await g.checkVideoStatus(t,r)).ready&&(D.updateVideoStatus(e,"completed"),u(),clearInterval(a),c(t=>{let r=new Set(t);return r.delete(e),r}))},5e3);setTimeout(()=>{clearInterval(a),c(t=>{let r=new Set(t);return r.delete(e),r})},6e5)};return(0,a.jsxs)("div",{className:"w-full max-w-6xl mx-auto px-4 py-8 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl md:text-4xl font-black text-vireo-dark dark:text-white mb-2",children:"Your Videos"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage and view all your Vireo creations"})]}),(0,a.jsxs)(m,{onClick:t,variant:"primary",size:"lg",className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"w-5 h-5"}),"Create New"]})]}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)(V.A,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-400 dark:text-gray-500 mb-2",children:"No videos yet"}),(0,a.jsx)("p",{className:"text-gray-400 dark:text-gray-500 mb-6",children:"Start creating your first Vireo story!"}),(0,a.jsx)(m,{onClick:t,variant:"primary",children:"Create Your First Video"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl overflow-hidden border-2 border-gray-100 dark:border-gray-700 hover:border-vireo-teal dark:hover:border-vireo-teal transition-all duration-300 shadow-sm hover:shadow-xl",children:[(0,a.jsxs)("div",{className:"aspect-video bg-gradient-to-br from-vireo-teal/20 to-vireo-purple/20 dark:from-vireo-teal/10 dark:to-vireo-purple/10 flex items-center justify-center relative group",children:[(0,a.jsx)(V.A,{className:"w-12 h-12 text-vireo-teal opacity-50"}),"completed"===e.status&&(0,a.jsx)("button",{onClick:()=>r(e),className:"absolute inset-0 bg-black/0 group-hover:bg-black/50 transition-all flex items-center justify-center",children:(0,a.jsx)(I.A,{className:"w-16 h-16 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-vireo-dark dark:text-white mb-1 truncate",children:e.clipNames.join(", ")||"Untitled Video"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(e=>{switch(e){case"generating":return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 rounded-full text-sm font-medium",children:[(0,a.jsx)(T.A,{className:"w-4 h-4 animate-spin"}),"Generating"]});case"completed":return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400 rounded-full text-sm font-medium",children:[(0,a.jsx)(R.A,{className:"w-4 h-4"}),"Completed"]});case"failed":return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400 rounded-full text-sm font-medium",children:[(0,a.jsx)(z.A,{className:"w-4 h-4"}),"Failed"]})}})(e.status),"completed"===e.status&&(0,a.jsx)("button",{onClick:()=>r(e),className:"text-vireo-teal hover:text-vireo-purple font-bold text-sm transition-colors",children:"View →"})]})]})]},e.id))})]})},O=e=>{let{isCooking:t=!1,className:r=""}=e;return(0,a.jsx)("div",{className:"relative ".concat(r),children:(0,a.jsx)("img",{src:"/vireo-animated-logo.svg",alt:"Vireo Bird",className:"w-full h-full object-contain ".concat(t?"animate-pulse":"")})})};var L=r(5740),M=r(5917),G=r(5299);let B="http://44.200.94.8:8000",q={async createOrder(e){let t=await fetch("".concat(B,"/create-order"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,amount:9900,currency:"INR"})});if(!t.ok)throw Error((await t.json().catch(()=>({detail:t.statusText}))).detail||"Failed to create payment order");return t.json()},async verifyPayment(e,t,r,a){let n=await fetch("".concat(B,"/verify-payment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_order_id:e,razorpay_payment_id:t,razorpay_signature:r,userId:a})});if(!n.ok)throw Error((await n.json().catch(()=>({detail:n.statusText}))).detail||"Payment verification failed");return n.json()},openCheckout(e,t,r,a){if(!window.Razorpay)return void a(Error("Razorpay SDK not loaded. Please refresh the page."));let n={key:"rzp_test_Rn7o9oAiC8Caq8",amount:e.amount,currency:e.currency,name:"Vireo",description:"Unlimited Video Generation - Lifetime Access",order_id:e.id,handler:function(e){r({razorpay_payment_id:e.razorpay_payment_id,razorpay_order_id:e.razorpay_order_id,razorpay_signature:e.razorpay_signature})},prefill:{name:t.name,email:t.email||""},theme:{color:"#14B8A6"},modal:{ondismiss:function(){a(Error("Payment cancelled by user"))}}},i=new window.Razorpay(n);i.on("payment.failed",function(e){var t;a(Error((null==(t=e.error)?void 0:t.description)||"Payment failed"))}),i.open()},loadScript:()=>new Promise(e=>{if(window.Razorpay)return void e(!0);let t=document.createElement("script");t.src="https://checkout.razorpay.com/v1/checkout.js",t.onload=()=>e(!0),t.onerror=()=>e(!1),document.body.appendChild(t)})},J="vireo_user_quotas",Q={getUserQuota(e){let t=this._loadFromStorage(),r=t.find(t=>t.userId===e);if(r)return r;let a={userId:e,generationCount:0,isPremium:!1};return t.push(a),this._saveToStorage(t),a},canGenerate(e){let t=this.getUserQuota(e);return t.isPremium||t.generationCount<2},getRemainingGenerations(e){let t=this.getUserQuota(e);return t.isPremium?1/0:Math.max(0,2-t.generationCount)},incrementGenerationCount(e){let t=this._loadFromStorage(),r=t.find(t=>t.userId===e);if(r)return r.generationCount+=1,this._saveToStorage(t),r;let a={userId:e,generationCount:1,isPremium:!1};return t.push(a),this._saveToStorage(t),a},upgradeToPremium(e){let t=this._loadFromStorage(),r=t.find(t=>t.userId===e);return r?(r.isPremium=!0,r.premiumSince=Date.now()):(r={userId:e,generationCount:0,isPremium:!0,premiumSince:Date.now()},t.push(r)),this._saveToStorage(t),r},syncFromBackend(e,t){let r=this._loadFromStorage(),a=r.find(t=>t.userId===e);return a?(a.generationCount=Math.max(a.generationCount,t.generationCount),t.isPremium&&!a.isPremium&&(a.isPremium=!0,a.premiumSince=Date.now())):(a={userId:e,generationCount:t.generationCount,isPremium:t.isPremium,premiumSince:t.isPremium?Date.now():void 0},r.push(a)),this._saveToStorage(r),a},_loadFromStorage(){try{let e=localStorage.getItem(J);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load quotas from storage:",e),[]}},_saveToStorage(e){try{localStorage.setItem(J,JSON.stringify(e))}catch(e){console.error("Failed to save quotas to storage:",e)}}},H=e=>{let{isOpen:t,onClose:r,onPaymentSuccess:i,userId:o,userName:s,userEmail:l,remainingGenerations:d}=e,[c,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(null);if(!t)return null;let g=async()=>{u(!0),p(null);try{if(!await q.loadScript())throw Error("Failed to load payment gateway");let e=await q.createOrder(o);q.openCheckout(e,{name:s,email:l},async e=>{try{(await q.verifyPayment(e.razorpay_order_id,e.razorpay_payment_id,e.razorpay_signature,o)).success?(Q.upgradeToPremium(o),i()):p("Payment verification failed. Please contact support.")}catch(e){p("Payment verification failed. Please contact support.")}u(!1)},e=>{"Payment cancelled by user"!==e.message&&p(e.message||"Payment failed. Please try again."),u(!1)})}catch(e){p(e.message||"Failed to initiate payment"),u(!1)}};return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-3xl p-8 max-w-md w-full mx-4 shadow-2xl animate-fade-in",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,a.jsx)(x.A,{className:"w-5 h-5 text-gray-500"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-vireo-teal to-vireo-purple rounded-full flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(L.A,{className:"w-10 h-10 text-white"})}),(0,a.jsx)("h2",{className:"text-2xl font-black text-vireo-dark dark:text-white mb-2",children:d<=0?"You've used all free videos! \uD83C\uDFAC":"Upgrade to Unlimited"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6",children:d<=0?"You've enjoyed your ".concat(2," free videos."):"You have ".concat(d," free videos left.")}),(0,a.jsxs)("div",{className:"bg-vireo-teal/10 rounded-2xl p-6 mb-6",children:[(0,a.jsxs)("div",{className:"text-4xl font-black text-vireo-teal mb-1",children:["₹",99]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"One-time payment • Lifetime access"})]}),(0,a.jsx)("ul",{className:"text-left space-y-3 mb-8",children:["Unlimited video generations","Priority processing","Support indie development ❤️"].map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-3 text-gray-700 dark:text-gray-300",children:[(0,a.jsx)("div",{className:"w-5 h-5 bg-vireo-teal/20 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(M.A,{className:"w-3 h-3 text-vireo-teal"})}),e]},t))}),h&&(0,a.jsx)("div",{className:"text-red-500 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:h}),(0,a.jsx)(m,{size:"lg",variant:"primary",className:"w-full text-lg",onClick:g,disabled:c,children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(G.A,{className:"w-5 h-5 animate-spin mr-2"}),"Processing..."]}):"Upgrade Now ✨"}),d>0&&(0,a.jsx)("button",{onClick:r,className:"mt-4 text-sm text-gray-400 hover:text-gray-600 transition-colors",children:"Maybe later"})]})]})]})};var Y=r(6154);let Z=e=>{let{remainingGenerations:t,isPremium:r,onClick:n}=e;if(r)return(0,a.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 bg-gradient-to-r from-vireo-teal to-vireo-purple text-white rounded-full text-xs sm:text-sm font-bold",children:[(0,a.jsx)(L.A,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),(0,a.jsx)("span",{className:"hidden xs:inline",children:"Premium"}),(0,a.jsx)("span",{className:"inline xs:hidden",children:"Pro"})]});let i=t<=0;return(0,a.jsxs)("button",{onClick:n,className:"\n                flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-xs sm:text-sm font-bold transition-all\n                ".concat(i?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/50":t<=2?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400 hover:bg-yellow-200 dark:hover:bg-yellow-900/50":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600","\n            "),title:i?"Upgrade to continue":"".concat(t," of ").concat(2," free videos left"),children:[(0,a.jsx)(Y.A,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),i?"Upgrade":"".concat(t,"/").concat(2)]})},K=()=>{var e,t;let{isSignedIn:r,isLoaded:m,user:u}=(0,i.Jd)(),[x,h]=(0,n.useState)(c.LANDING),[p,f]=(0,n.useState)([]),[y,b]=(0,n.useState)(null),[w,N]=(0,n.useState)(!1),[k,S]=(0,n.useState)(!1),[C,P]=(0,n.useState)(null),[_,A]=(0,n.useState)(null),[E,T]=(0,n.useState)(null),[R,z]=(0,n.useState)(!1);(0,n.useEffect)(()=>{m&&r&&u&&(T(Q.getUserQuota(u.id)),g.getUserQuota(u.id).then(e=>{T(Q.syncFromBackend(u.id,e))}).catch(e=>{console.error("Failed to sync quota from backend:",e)}))},[m,r,u]),(0,n.useEffect)(()=>{k?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[k]);let V=async(e,t,a,n)=>{if(m){if(!r||!u)return void alert("Please sign in to upload videos.");N(!0),h(c.PROCESSING),(async()=>{try{let r,i;if("string"==typeof e)r=e,i=t;else{let t=await e;r=t.session_id,i=t.files}let o=await g.generateVideo(r,i,n),s={id:o.filename,filename:o.filename,status:"generating",createdAt:Date.now(),clipNames:a,userId:u.id,videoUrl:o.video_url};D.saveVideoRender(s),P(s),A(o.filename);let l=0,d=async()=>{l+=1;try{if((await g.checkVideoStatus(o.filename,o.video_url)).ready){let e={...s,status:"completed",videoUrl:o.video_url||s.videoUrl},t=Q.incrementGenerationCount(u.id);T(t),g.syncQuota(u.id,t.generationCount),D.saveVideoRender(e),P(e),b(e.videoUrl||g.getVideoUrl(e.filename)),N(!1),h(c.RESULT);return}}catch(e){console.error("Error checking video status",e)}l<40?setTimeout(d,3e3):(N(!1),h(c.DASHBOARD))};d()}catch(e){console.error("Error processing video:",e),await g.logError(e),alert("Failed to start video generation. Please try again."),N(!1)}})()}},I=()=>{p.forEach(e=>URL.revokeObjectURL(e.previewUrl)),f([]),b(null),P(null),h(c.LANDING)},L=()=>{h(c.DASHBOARD)},M=()=>{z(!0)};return(0,a.jsxs)("div",{className:"min-h-screen bg-vireo-offwhite font-sans text-vireo-dark overflow-x-hidden relative dark:bg-gray-900 dark:text-white transition-colors duration-300",children:[(0,a.jsxs)("header",{className:"w-full p-3 sm:p-6 flex items-center justify-between max-w-7xl mx-auto z-50 relative",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:I,children:[(0,a.jsx)(O,{className:"w-20 h-20 transform group-hover:rotate-12 transition-transform duration-300"}),(0,a.jsx)("span",{className:"text-2xl font-black tracking-tight text-vireo-dark group-hover:text-vireo-teal transition-colors dark:text-white",children:"Vireo"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,a.jsx)("button",{onClick:()=>{S(!k)},className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors","aria-label":"Toggle Dark Mode",children:k?(0,a.jsx)(s.A,{className:"w-6 h-6 text-yellow-400"}):(0,a.jsx)(l.A,{className:"w-6 h-6 text-vireo-dark"})}),(0,a.jsxs)(o.iB,{children:[E&&(0,a.jsx)(Z,{remainingGenerations:Q.getRemainingGenerations((null==u?void 0:u.id)||""),isPremium:E.isPremium,onClick:M}),(0,a.jsx)("button",{onClick:L,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors","aria-label":"Go to Dashboard",title:"Dashboard",children:(0,a.jsx)(d.A,{className:"w-6 h-6 text-vireo-dark dark:text-white"})})]}),(0,a.jsx)(o.Bl,{children:(0,a.jsx)(i.hZ,{mode:"modal",children:(0,a.jsx)("button",{className:"px-4 py-2 bg-vireo-teal text-white rounded-lg font-bold hover:bg-opacity-90 transition-all",children:"Sign In"})})}),(0,a.jsx)(o.iB,{children:(0,a.jsx)(i.uF,{})})]})]}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-8 md:py-16 flex flex-col items-center justify-center min-h-[calc(100vh-100px)]",children:[x===c.LANDING&&(0,a.jsx)(v,{onStartProcessing:V,isSignedIn:r,isProcessing:w,userId:null==u?void 0:u.id,userName:(null==u?void 0:u.fullName)||(null==u?void 0:u.firstName)||(null==u?void 0:u.username)||"User",userEmail:null==u||null==(e=u.primaryEmailAddress)?void 0:e.emailAddress,canGenerate:!E||Q.canGenerate((null==u?void 0:u.id)||""),onShowPaymentModal:M}),x===c.PROCESSING&&(0,a.jsx)(j,{}),x===c.DASHBOARD&&(0,a.jsx)(F,{onCreateNew:()=>{h(c.LANDING)},onViewVideo:e=>{P(e),b(e.videoUrl||g.getVideoUrl(e.filename)),h(c.RESULT)}}),x===c.RESULT&&(0,a.jsx)(U,{clips:p,videoUrl:y,onReset:I,onViewGallery:L})]}),u&&(0,a.jsx)(H,{isOpen:R,onClose:()=>z(!1),onPaymentSuccess:()=>{z(!1),u&&T(Q.getUserQuota(u.id))},userId:u.id,userName:u.fullName||u.firstName||u.username||"User",userEmail:null==(t=u.primaryEmailAddress)?void 0:t.emailAddress,remainingGenerations:Q.getRemainingGenerations(u.id)}),(0,a.jsx)("footer",{className:"w-full py-6 text-center text-sm text-gray-600 dark:text-gray-400",children:(0,a.jsx)("p",{children:"Made with ❤️ by Noah and Rajat"})}),(0,a.jsxs)("div",{className:"fixed top-0 left-0 w-full h-full pointer-events-none -z-10 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-[-10%] left-[-5%] w-[400px] h-[400px] bg-vireo-teal rounded-full opacity-5 blur-3xl"}),(0,a.jsx)("div",{className:"absolute bottom-[-10%] right-[-5%] w-[500px] h-[500px] bg-vireo-purple rounded-full opacity-5 blur-3xl"}),(0,a.jsx)("div",{className:"absolute top-[40%] right-[10%] w-[200px] h-[200px] bg-vireo-pink rounded-full opacity-5 blur-3xl"})]})]})};function W(){return(0,a.jsx)(K,{})}}},e=>{e.O(0,[798,869,85,441,255,358],()=>e(e.s=5387)),_N_E=e.O()}]);